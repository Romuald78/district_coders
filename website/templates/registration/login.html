{% extends "district/common/base.html" %}
{% load static %}

{% block page_header %}
  {% with page_title="Log in" %}
    {{ block.super }}
  {% endwith %}
{% endblock %}

{% block page_content %}

<div class="flex items-center justify-center text-amber-300 font-mono min-h-screen">
  <div class="relative flex flex-col md:flex-row-reverse m-6 space-y-8 md:space-y-0 bg-zinc-900 shadow-[0_0_10px_rgba(251,191,36,0.3)] rounded-3xl w-full max-w-7xl border-2 border-amber-600">

    <!-- Form Side -->
    <div class="flex flex-col justify-center p-10 w-full md:w-1/2">
      <h1 class="mb-3 text-3xl font-extrabold tracking-wide text-amber-400 uppercase drop-shadow-[0_0_5px_rgba(251,191,36,0.7)]">Welcome back</h1>
      <p class="font-light text-amber-400 mb-8 text-sm drop-shadow-[0_0_3px_rgba(251,191,36,0.5)]">Please enter your credentials to log in.</p>

        {% if form.non_field_errors %}
              <div class="text-sm text-red-500 mb-4 font-mono drop-shadow-[0_0_3px_rgba(255,0,0,0.8)]">
                {% for error in form.non_field_errors %}
                  <p>{{ error }}</p>
                {% endfor %}
              </div>
            {% endif %}


      <form method="post" class="space-y-5">
        {% csrf_token %}
        {% for field in form %}
          <div>
            <label for="{{ field.id_for_label }}" class="block text-sm font-semibold mb-1 text-amber-400 uppercase tracking-wide drop-shadow-[0_0_4px_rgba(251,191,36,0.6)]">
              {{ field.label }}
            </label>
            <div class="relative">
              <div class="relative rounded-md bg-transparent ring-1 ring-amber-600 shadow-[0_0_8px_rgba(251,191,36,0.2)] transition focus-within:ring-2 focus-within:ring-amber-400">

                {% if field.field.widget.input_type == "password" %}
                  <input type="password" name="{{ field.html_name }}" id="{{ field.auto_id }}"
                         class="w-full px-3 py-2 pr-10 text-sm bg-transparent text-amber-300 placeholder-amber-600 outline-none h-10"
                         {% if field.value %}value="{{ field.value }}"{% endif %} autocomplete="current-password">

                  <button type="button"
                          onclick="togglePassword('{{ field.id_for_label }}', 'icon-{{ field.id_for_label }}')"
                          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-amber-400 hover:text-amber-200 transition w-6 h-6 flex items-center justify-center drop-shadow-[0_0_5px_rgba(251,191,36,0.7)]">
                    <i id="icon-{{ field.id_for_label }}" class="fa-solid fa-eye text-[1.25rem]"></i>
                  </button>

                {% else %}
                  <input type="{{ field.field.widget.input_type }}" name="{{ field.html_name }}" id="{{ field.auto_id }}"
                         class="w-full px-3 py-2 text-sm bg-transparent text-amber-300 placeholder-amber-600 outline-none"
                         {% if field.value %}value="{{ field.value }}"{% endif %}>
                {% endif %}
              </div>

              {% if field.errors %}
                <div class="text-sm text-red-500 mt-1 font-mono drop-shadow-[0_0_3px_rgba(255,0,0,0.8)]">
                  {{ field.errors }}
                </div>
              {% endif %}
            </div>
          </div>
        {% endfor %}

        <button type="submit" class="w-full mt-4 bg-amber-700 text-white font-extrabold py-2 rounded-md hover:bg-amber-600 transition shadow-[0_0_10px_rgba(251,191,36,0.5)]">
          Log in
        </button>
      </form>

      <div class="flex justify-between text-sm text-amber-400 mt-6 font-mono drop-shadow-[0_0_4px_rgba(251,191,36,0.6)]">
        <a href="{% url 'password_reset' %}" class="hover:underline">Forgot password?</a>
        <a href="{% url 'signup' %}" class="font-extrabold text-amber-300 hover:underline drop-shadow-[0_0_6px_rgba(251,191,36,0.7)]">Create an account</a>
      </div>
    </div>

    <!-- Image Side (LEFT SIDE this time) -->
    <div class="relative hidden md:block md:w-1/2 overflow-hidden rounded-l-3xl">
      <img
        src="{% static 'images/sign_up.png' %}"
        alt="Digital theme"
        class="w-full h-full object-cover brightness-75"
      />
      <div class="absolute bottom-6 left-6 p-4 bg-zinc-900 bg-opacity-80 backdrop-blur-sm rounded text-sm text-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.7)] font-mono drop-shadow-[0_0_5px_rgba(251,191,36,0.7)]">
        "Access granted. Let the journey begin."
      </div>
    </div>

  </div>
</div>

<script>
  function togglePassword(inputId, iconId) {
    const input = document.getElementById(inputId);
    const icon = document.getElementById(iconId);
    if (input && icon) {
      if (input.type === "password") {
        input.type = "text";
        icon.classList.remove("fa-eye");
        icon.classList.add("fa-eye-slash");
      } else {
        input.type = "password";
        icon.classList.remove("fa-eye-slash");
        icon.classList.add("fa-eye");
      }
    }
  }
</script>

{% endblock %}
